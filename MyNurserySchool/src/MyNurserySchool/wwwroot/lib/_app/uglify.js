!function(e){"use strict";e.module("common",[])}(angular),function(e){"use strict";e.module("app.nursery",["common","ngRoute","ngAnimate","mgcrea.ngStrap","ui.bootstrap"]).config(["$routeProvider",function(e){e.when("/nurseries",{controller:"NurseriesListController",controllerAs:"vm",templateUrl:"/app/Nurseries/nurseries-list.view.html"}),e.when("/edit/:id",{controller:"NurseryAdminEditController",controllerAs:"vm",templateUrl:"/app/Nurseries/nursery-edit.view.html"}),e.when("/users",{controller:"UsersListController",controllerAs:"vm",templateUrl:"/app/User/users-list.view.html"}),e.when("/",{controller:"NurseryDetailController",controllerAs:"vm",templateUrl:"/app/Nursery/nursery-detail.view.html"}),e.when("/edit",{controller:"NurseryEditController",controllerAs:"vm",templateUrl:"/app/Nursery/nursery-edit.view.html"}),e.when("/class/:id/edit",{controller:"ClassEditController",controllerAs:"vm",templateUrl:"/app/Class/class-edit.view.html"}),e.when("/class/:id",{controller:"ClassDetailController",controllerAs:"vm",templateUrl:"/app/Class/class-detail.view.html"}),e.when("/employee/:id/edit",{controller:"EmployeeEditController",controllerAs:"vm",templateUrl:"/app/Employee/employee-edit.view.html"}),e.when("/employee/:id",{controller:"EmployeeDetailController",controllerAs:"vm",templateUrl:"/app/Employee/employee-detail.view.html"}),e.when("/child/:id/edit",{controller:"ChildEditController",controllerAs:"vm",templateUrl:"/app/Child/child-edit.view.html"}),e.when("/child/:id",{controller:"ChildDetailController",controllerAs:"vm",templateUrl:"/app/Child/child-detail.view.html"}),e.when("/employees",{controller:"EmployeesListController",controllerAs:"vm",templateUrl:"/app/Employee/employees-list.view.html"}),e.when("/children",{controller:"ChildrenListController",controllerAs:"vm",templateUrl:"/app/Child/children-list-all.view.html"}),e.when("/children/waiting",{controller:"ChildrenListController",controllerAs:"vm",templateUrl:"/app/Child/children-list-waiting.view.html"}),e.when("/children/archive",{controller:"ChildrenListController",controllerAs:"vm",templateUrl:"/app/Child/children-list-archived.view.html"}),e.otherwise({redirectTo:"/"})}])}(angular),function(e){"use strict";function t(e){this.getAllNurseries=function(){return e.get("/api/nurseries")},this.getNursery=function(t){return e.get("/api/nursery/"+t)},this.insertNursery=function(t){return e.post("/api/nursery",t)},this.updateNursery=function(t){return e.put("/api/nursery",t)},this.deleteNursery=function(t){return e["delete"]("/api/nursery/"+t)},this.getAllClasses=function(t){return e.get("/api/nursery/"+t+"/classes/")},this.getClass=function(t){return e.get("/api/class/"+t)},this.insertClass=function(t,n){return e.post("/api/class/"+t,n)},this.updateClass=function(t,n){return e.put("/api/class/"+t,n)},this.deleteClass=function(t){return e["delete"]("/api/class/"+t)},this.getAllChildren=function(t){return e.get("/api/nursery/"+t+"/children")},this.getChild=function(t){return e.get("/api/child/"+t)},this.insertChild=function(t){return e.post("/api/child/",t)},this.updateChild=function(t){return e.put("/api/child/",t)},this.deleteChild=function(t){return e["delete"]("/api/child/"+t)},this.getAllEmployees=function(t){return e.get("/api/nursery/"+t+"/employees")},this.getEmployee=function(t){return e.get("/api/employee/"+t)},this.insertEmployee=function(t,n){return e.post("/api/employee/"+t,n)},this.updateEmployee=function(t,n){return e.put("/api/employee/"+t,n)},this.deleteEmployee=function(t){return e["delete"]("/api/employee/"+t)},this.insertNote=function(t){return e.post("/api/note/",t)},this.deleteNote=function(t){return e["delete"]("/api/note/"+t)},this.getRoles=function(){return e.get("/api/roles")},this.getUsers=function(){return e.get("/Api/Users")}}e.module("app.nursery").service("DataService",["$http",t])}(angular),function(e){"use strict";function t(t,n,o,r,s,l,i){l("BaseController",{$scope:t});var a=this;a.childId=r.id,a.nurseryId=parseInt(r.nursId),a.child={},a.newNote={},a.attendanceStates=["Žiadateľ","Docházdajúci","Odstúpený"],a.isBusy=!0,i.getChild(a.childId).then(function(t){e.copy(t.data,a.child),a.classId=a.child.classId,a.child.description=a.child.description?s.trustAsHtml(a.child.description.replace(/(\r\n|\n|\r)/gm,"<br />")):null,a.child.contacts=a.child.contacts?s.trustAsHtml(a.child.contacts.replace(/(\r\n|\n|\r)/gm,"<br />")):null;for(var n=0;n<a.child.notes.length;n++)null!=a.child.notes[n].text&&(a.child.notes[n].text=s.trustAsHtml(a.child.notes[n].text.replace(/(\r\n|\n|\r)/gm,"<br />")))},function(){toastr.error("Nepodarilo sa načítať informácie o dieťati")})["finally"](function(){a.isBusy=!1}),a.deleteChild=function(){a.isBusy=!0,i.getChild(a.child.id).then(function(){toastr.success("Dieťa bolo vymazané"),o.path("#/class/"+a.classId)},function(e){toastr.error("Dieťa sa nepodarilo vymazať")})["finally"](function(){a.isBusy=!1})},a.saveNote=function(){a.isBusy=!0,a.newNote.childId=a.childId,i.insertNote(a.newNote).then(function(e){a.child.notes.push(e.data),a.child.notes[a.child.notes.length-1].text=s.trustAsHtml(a.child.notes[a.child.notes.length-1].text.replace(/(\r\n|\n|\r)/gm,"<br />")),toastr.success("Poznámka bola zapísaná"),a.newNote={}},function(e){toastr.error("Poznámku sa nepodarilo zapísať")})["finally"](function(){a.isBusy=!1})},a.deleteNote=function(e){a.isBusy=!0,i.deleteNote(e).then(function(){for(var t=0;t<a.child.notes.length;t++){var n=a.child.notes[t];n.id==e&&a.child.notes.splice(t,1)}toastr.success("Poznámka bola vymazaná")},function(e){toastr.error("Poznámku sa nepodarilo vymazať")})["finally"](function(){a.isBusy=!1})}}t.$inject=["$scope","$http","$location","$routeParams","$sce","$controller","DataService"],e.module("app.nursery").controller("ChildDetailController",t)}(angular),function(e){"use strict";function t(t,n,o,r,s,l,i){s("BaseController",{$scope:t});var a=this;a.childId=r.id,a.nurseryId=n.nursery.id,a.child={},a.classId=0,a.isNew=0==a.childId,t.attendance=[{id:0,name:"Žiadateľ"},{id:1,name:"Dochádzajúci"},{id:2,name:"Odstúpený"}],a.classes=[],i.getAllClasses(a.nurseryId).then(function(n){e.copy(n.data,a.classes),t.classes=a.classes},function(){toastr.error("Nepodarilo sa načítať informácie o triedach")})["finally"](function(){a.isBusy=!1}),a.isNew||(a.isBusy=!0,i.getChild(a.childId).then(function(t){e.copy(t.data,a.child),a.classId=a.child.classId},function(){toastr.error("Nepodarilo sa načítať informácie o dieťati")})["finally"](function(){a.isBusy=!1})),a.saveChild=function(e){e&&(a.isBusy=!0,a.child.nurseryId=a.nurseryId,a.isNew?i.insertChild(a.child).then(function(e){toastr.success("Dieťa "+a.child.firstName+" "+a.child.lastName+" bolo úspešne vytvorené"),t.back()},function(){toastr.error("Dieťa sa nepodarilo vytvoriť")})["finally"](function(){a.isBusy=!1}):(null==a.child.classId&&(a.child.classId=a.classId),i.updateChild(a.child).then(function(e){toastr.success("Zmeny v dieťati "+a.child.firstName+" "+a.child.lastName+" boli úspešne uložené"),t.back()},function(){toastr.error("Dieťa sa nepodarilo uložiť")})["finally"](function(){a.isBusy=!1})))},a.deleteChildModal=function(){t.deleteModalTarget="dieťa "+a.child.firstName+" "+a.child.lastName;var e=l.open({templateUrl:"/app/common/templates/delete-modal.template.html",controller:"DeleteModalController",scope:t});e.result.then(function(){a.deleteChild()})},a.deleteChild=function(){a.isBusy=!0,i.deleteChild(a.child.id).then(function(){toastr.success("Dieťa bolo vymazané"),t.back()},function(e){toastr.error("Dieťa sa nepodarilo vymazať")})["finally"](function(){a.isBusy=!1})}}t.$inject=["$scope","$rootScope","$http","$routeParams","$controller","$uibModal","DataService"],e.module("app.nursery").controller("ChildEditController",t)}(angular),function(e){"use strict";function t(t,n,o,r,s,l){function i(){l.getNursery(a.nurseryId).then(function(e){if(e.data.classes)for(var t=0;t<e.data.classes.length;t++)a.classes[e.data.classes[t].id]=e.data.classes[t].name},function(e){toastr.error("Nepodarilo sa načítať zoznam škôlok:<br/>"+e.data.message)}),l.getAllChildren(a.nurseryId).then(function(t){if(e.copy(t.data,a.children),a.children.length>0)for(var n=0;n<a.children.length;n++)a.children[n].fullName=a.children[n].firstName+" "+a.children[n].lastName,a.children[n].className=a.classes[a.children[n].classId],a.children[n].contacts&&(a.children[n].contacts=o.trustAsHtml(a.children[n].contacts.replace(/(\r\n|\n|\r)/gm,"<br />"))),a.children[n].description&&(a.children[n].description=o.trustAsHtml(a.children[n].description.replace(/(\r\n|\n|\r)/gm,"<br />"))),0==a.children[n].attendance?a.waitingChildren.push(a.children[n]):1==a.children[n].attendance?a.attendantChildren.push(a.children[n]):2==a.children[n].attendance&&a.archivedChildren.push(a.children[n])},function(e){toastr.error("Nepodarilo sa načítať zoznam detí:<br/>"+e.data.message)})["finally"](function(){a.isBusy=!1})}r("BaseController",{$scope:t});var a=this;a.nurseryId=s.nursery.id,a.children=[],a.attendantChildren=[],a.waitingChildren=[],a.archivedChildren=[],a.classes=[],a.isBusy=!0,t.sortType="birthDate",i()}t.$inject=["$scope","$http","$sce","$controller","$rootScope","DataService"],e.module("app.nursery").controller("ChildrenListController",t)}(angular),function(e){"use strict";function t(t,n,o,r,s,l,i,a){i("BaseController",{$scope:t});var c=this;c.classId=r.id,c.nurseryId=n.nursery.id,c["class"]={},c.children=[],c.isBusy=!0,a.getClass(c.classId).then(function(t){e.copy(t.data,c["class"]);for(var n=0;n<c["class"].children.length;n++)c["class"].children[n].fullName=c["class"].children[n].firstName+" "+c["class"].children[n].lastName,c["class"].children[n].contacts&&(c["class"].children[n].contacts=s.trustAsHtml(c["class"].children[n].contacts.replace(/(\r\n|\n|\r)/gm,"<br />"))),c["class"].children[n].description&&(c["class"].children[n].description=s.trustAsHtml(c["class"].children[n].description.replace(/(\r\n|\n|\r)/gm,"<br />"))),1==c["class"].children[n].attendance&&c.children.push(c["class"].children[n])},function(e){toastr.error("Nepodarilo sa načítať informácie o triede")})["finally"](function(){c.isBusy=!1})}t.$inject=["$scope","$rootScope","$http","$routeParams","$sce","$window","$controller","DataService"],e.module("app.nursery").controller("ClassDetailController",t)}(angular),function(){"use strict";function e(e,t,n,o,r,s,l,i){s("BaseController",{$scope:e});var a=this;a.classId=r.id,a.nurseryId=t.nursery.id,a.nursery={},a["class"]={},a.isNew=0==a.classId,a.isBusy=!0,i.getNursery(a.nurseryId).then(function(e){if(angular.copy(e.data,a.nursery),!a.isNew)for(var t=0,n=a.nursery.classes.length;n>t;t++)a.nursery.classes[t].id==a.classId&&angular.copy(a.nursery.classes[t],a["class"])},function(){toastr.error("Nepodarilo sa načítať informácie o triede")})["finally"](function(){a.isBusy=!1}),a.saveClass=function(e){e&&(a.isBusy=!0,a.isNew?i.insertClass(a.nursery.id,a["class"]).then(function(e){toastr.success("Trieda "+a["class"].name+" bola úspešne vytvorená"),o.path("#/")},function(){toastr.error("Triedu sa nepodarilo vytvoriť")})["finally"](function(){a.isBusy=!1}):i.updateClass(a.nursery.id,a["class"]).then(function(e){toastr.success("Zmeny v triede "+a["class"].name+" boli úspešne uložené"),o.path("#/")},function(){toastr.error("Triedu sa nepodarilo uložiť")})["finally"](function(){a.isBusy=!1}))},a.deleteClassModal=function(){e.deleteModalTarget="triedu "+a["class"].name;var t=l.open({templateUrl:"/app/common/templates/delete-modal.template.html",controller:"DeleteModalController",scope:e});t.result.then(function(){a.deleteClass()})},a.deleteClass=function(){a.isBusy=!0;var t=a["class"].name;i.deleteClass(a["class"].id).then(function(){toastr.success("Trieda "+t+" bola vymazaná"),e.back()},function(e){toastr.error("Triedu sa nepodarilo vymazať")})["finally"](function(){a.isBusy=!1})}}e.$inject=["$scope","$rootScope","$http","$location","$routeParams","$controller","$uibModal","DataService"],angular.module("app.nursery").controller("ClassEditController",e)}(),function(e){"use strict";function t(t,n,o,r,s,l,i,a){i("BaseController",{$scope:t});var c=this;c.employeeId=s.id,c.nurseryId=n.nursery.id,c.employee={},c.newNote={},c.attendanceStates=["Žiadateľ","Pracujúci","Odstúpený"],c.isBusy=!0,a.getEmployee(c.employeeId).then(function(t){e.copy(t.data,c.employee),c.employee.description=c.employee.description?l.trustAsHtml(c.employee.description.replace(/(\r\n|\n|\r)/gm,"<br />")):null;for(var n=0;n<c.employee.notes.length;n++)null!=c.employee.notes[n].text&&(c.employee.notes[n].text=l.trustAsHtml(c.employee.notes[n].text.replace(/(\r\n|\n|\r)/gm,"<br />")))},function(){toastr.error("Nepodarilo sa načítať informácie o zamestnancovi:<br/>")})["finally"](function(){c.isBusy=!1}),c.saveNote=function(){c.isBusy=!0,c.newNote.employeeId=c.employeeId,a.insertNote(c.newNote).then(function(e){c.employee.notes.push(e.data),c.employee.notes[c.employee.notes.length-1].text=l.trustAsHtml(c.employee.notes[c.employee.notes.length-1].text.replace(/(\r\n|\n|\r)/gm,"<br />")),toastr.success("Poznámka bola zapísaná"),c.newNote={}},function(e){toastr.error("Poznámku sa nepodarilo zapísať")})["finally"](function(){c.isBusy=!1})},c.deleteNote=function(e){c.isBusy=!0,a.deleteNote(e).then(function(){for(var t=0;t<c.employee.notes.length;t++){var n=c.employee.notes[t];n.id==e&&c.employee.notes.splice(t,1)}toastr.success("Poznámka bola vymazaná")},function(e){toastr.error("Poznámku sa nepodarilo vymazať")})["finally"](function(){c.isBusy=!1})}}t.$inject=["$scope","$rootScope","$http","$location","$routeParams","$sce","$controller","DataService"],e.module("app.nursery").controller("EmployeeDetailController",t)}(angular),function(e){"use strict";function t(t,n,o,r,s,l,i){s("BaseController",{$scope:t});var a=this;a.employeeId=r.id,a.nurseryId=n.nursery.id,a.employee={},a.isNew=0==a.employeeId,t.attendance=[{id:0,name:"Žiadateľ"},{id:1,name:"Pracujúci"},{id:2,name:"Odstúpený"}],t.employmentTypes=[{value:"Dohoda"},{value:"Plný úväzok"},{value:"Študentská dohoda"},{value:"Skrátený úväzok"},{value:"Živnosť"}],a.isNew||(a.isBusy=!0,i.getEmployee(a.employeeId).then(function(t){e.copy(t.data,a.employee)},function(){toastr.error("Nepodarilo sa načítať informácie o zamestnancovi")})["finally"](function(){a.isBusy=!1})),a.saveEmployee=function(e){e&&(a.isBusy=!0,a.isNew?i.insertEmployee(a.nurseryId,a.employee).then(function(e){toastr.success("Zamestnanec "+a.employee.fullName+" bol úspešne vytvorený"),t.back()},function(){toastr.error("Zamestnanca sa nepodarilo vytvoriť")})["finally"](function(){a.isBusy=!1}):i.updateEmployee(a.nurseryId,a.employee).then(function(e){toastr.success("Zmeny v zamestnancovi "+a.employee.fullName+" boli úspešne uložené"),t.back()},function(){toastr.error("Zamestnanca sa nepodarilo uložiť")})["finally"](function(){a.isBusy=!1}))},a.deleteEmployeeModal=function(){t.deleteModalTarget="zamestnanca "+a.employee.fullName;var e=l.open({templateUrl:"/app/common/templates/delete-modal.template.html",controller:"DeleteModalController",scope:t});e.result.then(function(){a.deleteEmployee()})},a.deleteEmployee=function(){a.isBusy=!0,i.deleteEmployee(a.employee.id).then(function(){toastr.success("Zamestnanec bol vymazaný"),t.back()},function(e){toastr.error("Zamestnanca sa nepodarilo vymazať")})["finally"](function(){a.isBusy=!1})}}t.$inject=["$scope","$rootScope","$http","$routeParams","$controller","$uibModal","DataService"],e.module("app.nursery").controller("EmployeeEditController",t)}(angular),function(e){"use strict";function t(t,n,o,r,s,l){function i(){l.getAllEmployees(a.nurseryId).then(function(t){e.copy(t.data,a.employees),_.each(a.employees,function(e){e.editMode=!1})},function(e){toastr.error("Nepodarilo sa načítať zoznam zamestnancov")})["finally"](function(){a.isBusy=!1})}r("BaseController",{$scope:t});var a=this;a.nurseryId=s.nursery.id,a.employees=[],a.isBusy=!0,a.editing=!1,a.editedEmp={},t.attendance=[{id:0,name:"Žiadateľ"},{id:1,name:"Pracujúci"},{id:2,name:"Odstúpený"}],i(),a.activateEditMode=function(n){!a.editing&&t.canEdit&&o.outerWidth>768&&(e.copy(n,a.editedEmp),a.setEditMode(n.id,!0))},a.closeEditMode=function(e){a.setEditMode(e,!1),a.editedEmp={}},a.setEditMode=function(t,n,o){_.find(a.employees,function(r){r.id==t&&(r.editMode=n,a.editing=n,o&&e.copy(a.editedEmp,r))})},a.saveEmployee=function(e){var t=!0;t&&(a.isBusy=!0,l.updateEmployee(a.nurseryId,e).then(function(t){toastr.success("Zmeny v zamestnancovi "+e.fullName+" boli úspešne uložené"),a.setEditMode(e.id,!1,!0)},function(){toastr.error("Zamestnanca sa nepodarilo uložiť")})["finally"](function(){a.isBusy=!1}))}}t.$inject=["$scope","$http","$window","$controller","$rootScope","DataService"],e.module("app.nursery").controller("EmployeesListController",t)}(angular),function(e){"use strict";function t(t,n,o,r,s,l){function i(){l.getAllNurseries().then(function(t){e.copy(t.data,a.nurseries),s.nursery=null},function(e){toastr.error("Nepodarilo sa načítať dáta: "+e)})["finally"](function(){a.isBusy=!1})}var a=this;a.nurseries=[],a.isBusy=!0,i(),a.nurseryDblClick=function(e){o.location="/App/"+e.id}}t.$inject=["$http","$scope","$window","$location","$rootScope","DataService"],e.module("app.nursery").controller("NurseriesListController",t)}(angular),function(e){"use strict";function t(t,n,o,r,s,l){var i=this;i.nurseryId=parseInt(t.id),i.nursery={},i.isNew=0==i.id,i.isNew||(i.isBusy=!0,l.getNursery(i.nurseryId).then(function(t){e.copy(t.data,i.nursery)},function(){toastr.error("Nepodarilo sa načítať informácie o škôlke")})["finally"](function(){i.isBusy=!1})),i.saveNursery=function(){i.isBusy=!0,i.isNew?l.insertNursery(i.nursery).then(function(e){toastr.success("Bola vytvorená nová škôlka "+i.nursery.name),o.path("#/")},function(){toastr.error("Škôlku sa nepodarilo uložiť")})["finally"](function(){i.isBusy=!1}):l.updateNursery(i.nursery).then(function(e){toastr.success("Zmeny v škôlke "+i.nursery.name+" boli úspešne uložené"),o.path("#/")},function(){toastr.error("Škôlku sa nepodarilo uložiť")})["finally"](function(){i.isBusy=!1})},i.deleteNurseryModal=function(){s.deleteModalTarget="škôlku "+i.nursery.name;var e=r.open({templateUrl:"/app/common/templates/delete-modal.template.html",controller:"DeleteModalController",scope:s});e.result.then(function(){i.deleteNursery()})},i.deleteNursery=function(){i.isBusy=!0;var e=i.nursery.name;l.deleteNursery(i.nursery.id).then(function(){toastr.success("Škôlka "+e+" bola vymazaná"),o.path("#/")},function(t){toastr.error("Škôlku "+e+" sa nepodarilo vymazať")})["finally"](function(){i.isBusy=!1})}}t.$inject=["$routeParams","$http","$location","$uibModal","$scope","DataService"],e.module("app.nursery").controller("NurseryAdminEditController",t)}(angular),function(e){"use strict";function t(t,n,o,r,s,l,i){function a(){null!=n.nursery?(d.nurseryId=n.nursery.id,c()):r.path("/nurseries")}function c(){i.getNursery(d.nurseryId).then(function(t){if(e.copy(t.data,d.nursery),d.nursery.classes.length>0){d.isBusy=!0;for(var n=0;n<d.nursery.classes.length;n++)u(n)}},function(){toastr.error("Nepodarilo sa načítať informácie o škôlke")})["finally"](function(){d.isBusy=!1})}function u(e){i.getClass(d.nursery.classes[e].id).then(function(t){for(var n=0;n<t.data.children.length;n++)1==t.data.children[n].attendance&&d.nursery.classes[e].children.push(t.data.children[n])},function(){toastr.error("Nepodarilo sa načítať informácie o triede")})}l("BaseController",{$scope:t});var d=this;d.nursery={},d.isBusy=!0,t.sortType="title",t.sortReverse=!0,a()}t.$inject=["$scope","$rootScope","$http","$location","$window","$controller","DataService"],e.module("app.nursery").controller("NurseryDetailController",t)}(angular),function(e){"use strict";function t(t,n,o,r,s,l){r("BaseController",{$scope:t});var i=this;i.nurseryId=s.nursery.id,i.nursery={},i.isBusy=!0,l.getNursery(i.nurseryId).then(function(t){e.copy(t.data,i.nursery)},function(){toastr.error("Nepodarilo sa načítať informácie o škôlke")})["finally"](function(){i.isBusy=!1}),i.saveNursery=function(e){e&&(i.isBusy=!0,l.updateNursery(i.nursery).then(function(e){toastr.success("Zmeny v škôlke "+i.nursery.name+" boli úspešne uložené"),o.path("#/")},function(){toastr.error("Škôlku sa nepodarilo uložiť")})["finally"](function(){i.isBusy=!1}))}}t.$inject=["$scope","$http","$location","$controller","$rootScope","DataService"],e.module("app.nursery").controller("NurseryEditController",t)}(angular),function(e){"use strict";function t(e,t){e.ok=function(){t.close()},e.cancel=function(){t.dismiss("cancel")}}t.$inject=["$scope","$uibModalInstance"],e.module("app.nursery").controller("UserEditModalController",t)}(angular),function(e){"use strict";function t(t,n,o,r,s){var l=this;l.users=[],l.roles=[],l.nurseries=[],l.isBusy=!0,s.getUsers().then(function(t){e.copy(t.data,l.users),l.getRoles()},function(e){toastr.error("Nepodarilo sa načítať dáta: "+e)}),l.getRoles=function(){s.getRoles().then(function(t){e.copy(t.data,l.roles),l.getNurseries()},function(e){toastr.error("Nepodarilo sa načítať dáta: "+e)})},l.getNurseries=function(){s.getAllNurseries().then(function(t){e.copy(t.data,l.nurseries),l.joinData()},function(e){toastr.error("Nepodarilo sa načítať dáta: "+e)})},l.joinData=function(){_.each(l.users,function(e){e.nurseries=[],_.each(e.claims,function(t){if("Nursery"===t.claimType){var n=_.find(l.nurseries,function(e){return e.id===parseInt(t.claimValue)});e.nurseries.push({id:parseInt(t.claimValue),name:n.name})}}),e.userRoles=[],_.each(e.roles,function(t){var n=_.find(l.roles,function(e){return e.id==t.roleId});e.userRoles.push({id:n.id,name:n.name})})}),l.isBusy=!1},l.editModal=function(e){n.actualUser=e,n.roles=l.roles,n.nurseries=[],_.each(l.nurseries,function(e){n.nurseries.push({id:e.id,name:e.name})});var t=r.open({templateUrl:"/App/User/user-edit-modal.template.html",controller:"UserEditModalController",scope:n});t.result.then(function(){})},l.generateModal=function(e){},l.deleteModal=function(e){n.deleteModalTarget="používateľa "+e.userName;var t=r.open({templateUrl:"/app/common/templates/delete-modal.template.html",controller:"DeleteModalController",scope:n});t.result.then(function(){})},n.redirect=function(e){o.location.href=e}}t.$inject=["$http","$scope","$window","$uibModal","DataService"],e.module("app.nursery").controller("UsersListController",t)}(angular),function(e){"use strict";function t(e,t){e.redirect=function(e){t.location.href=e},e.back=function(){t.history.back()},e.back2=function(){t.history.go(-2)},e.exportAction=function(t){switch(t){case"excel":e.$broadcast("export-excel",{});break;case"doc":e.$broadcast("export-doc",{});break;default:console.log("no event caught")}}}t.$inject=["$scope","$window"],e.module("common").controller("BaseController",t)}(angular),function(e){"use strict";function t(e,t){e.ok=function(){t.close()},e.cancel=function(){t.dismiss("cancel")}}t.$inject=["$scope","$uibModalInstance"],e.module("common").controller("DeleteModalController",t)}(angular),function(e){"use strict";function t(e){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"/app/common/templates/back-button.template.html"}}t.$inject=["$window"],e.module("common").directive("backButton",t)}(angular),function(e){"use strict";function t(){return{restrict:"E",transclude:!0,replace:!0,template:'<div id="backtop"><a title="Späť na začiatok"><i class="fa fa-2x fa-chevron-up"></a></div>',link:function(e,t){e.speed=600,e.currentYPosition=function(){return this.pageYOffset?this.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0},e.smoothScroll=function(){var t=e.currentYPosition(),n=0,o=n>t?n-t:t-n;if(100>o)return void scrollTo(0,n);var r=Math.round(e.speed/100),s=Math.round(o/25),l=n>t?t+s:t-s,i=0;if(n>t)for(var a=t;n>a;a+=s)setTimeout("window.scrollTo(0, "+l+")",i*r),l+=s,l>n&&(l=n),i++;else for(var c=t;c>n;c-=s)setTimeout("window.scrollTo(0, "+l+")",i*r),l-=s,n>l&&(l=n),i++},e.button=t.find("a"),e.button.on("click",function(){e.smoothScroll(),t.removeClass("show")}),window.addEventListener("scroll",function(){window.pageYOffset>0?t.addClass("show"):t.removeClass("show")})}}}e.module("common").directive("backToTop",t)}(angular),function(e){"use strict";function t(e){return{restrict:"A",require:"ngModel",link:function(t,n,o,r){var s=function(e){void 0===e&&(e="");var t=e.replace(/[^-'\s]+/g,function(e){return e.charAt(0).toUpperCase()+e.substring(1)});return t!==e&&(r.$setViewValue(t),r.$render()),t};r.$parsers.push(s),s(e(o.ngModel)(t))}}}t.$inject=["$parse"],e.module("common").directive("capitalizeAllFirst",t)}(angular),function(e){"use strict";function t(e){return{restrict:"A",require:"ngModel",link:function(t,n,o,r){var s=function(e){void 0===e&&(e="");var t=e.charAt(0).toUpperCase()+e.substring(1);return t!==e&&(r.$setViewValue(t),r.$render()),t};r.$parsers.push(s),s(e(o.ngModel)(t))}}}t.$inject=["$parse"],e.module("common").directive("capitalizeFirst",t)}(angular),function(e){"use strict";function t(){return{restrict:"E",scope:{model:"="},templateUrl:"/app/common/templates/created-modified.template.html"}}e.module("common").directive("createdModified",t)}(angular),function(e){"use strict";function t(t,n,o,r){return{restrict:"AE",scope:{selectedModel:"=",options:"=",extraSettings:"=",events:"=",searchFilter:"=?",translationTexts:"=",groupBy:"@"},template:function(e,t){var n=!!t.checkboxes,o=!!t.groupBy,r='<div class="multiselect-parent btn-group dropdown-multiselect">';r+='<button type="button" class="dropdown-toggle" ng-class="settings.buttonClasses" ng-click="toggleDropdown()">{{getButtonText()}}</button>',r+="<ul class=\"dropdown-menu dropdown-menu-form\" ng-style=\"{display: open ? 'block' : 'none', height : settings.scrollable ? settings.scrollableHeight : 'auto' }\" style=\"overflow: none\" >",r+='<li ng-hide="!settings.showCheckAll || settings.selectionLimit > 0"><a data-ng-click="selectAll()"><span class="glyphicon glyphicon-ok"></span>  {{texts.checkAll}}</a>',r+='<li ng-show="settings.showUncheckAll"><a data-ng-click="deselectAll();"><span class="glyphicon glyphicon-remove"></span>   {{texts.uncheckAll}}</a></li>',r+='<li ng-hide="(!settings.showCheckAll || settings.selectionLimit > 0) && !settings.showUncheckAll" class="divider"></li>',r+='<li ng-show="settings.enableSearch"><div class="dropdown-header"><input type="text" class="form-control" style="width: 100%;" ng-model="searchFilter" placeholder="{{texts.searchPlaceholder}}" /></li>',r+='<li ng-show="settings.enableSearch" class="divider"></li>',o?(r+='<li ng-repeat-start="option in orderedItems | filter: searchFilter" ng-show="getPropertyForObject(option, settings.groupBy) !== getPropertyForObject(orderedItems[$index - 1], settings.groupBy)" role="presentation" class="dropdown-header">{{ getGroupTitle(getPropertyForObject(option, settings.groupBy)) }}</li>',r+='<li ng-repeat-end role="presentation">'):r+='<li role="presentation" ng-repeat="option in options | filter: searchFilter">',r+='<a role="menuitem" tabindex="-1" ng-click="setSelectedItem(getPropertyForObject(option,settings.idProp))">',r+=n?'<div class="checkbox"><label><input class="checkboxInput" type="checkbox" ng-click="checkboxClick($event, getPropertyForObject(option,settings.idProp))" ng-checked="isChecked(getPropertyForObject(option,settings.idProp))" /> {{getPropertyForObject(option, settings.displayProp)}}</label></div></a>':"<span data-ng-class=\"{'glyphicon glyphicon-ok': isChecked(getPropertyForObject(option,settings.idProp))}\"></span> {{getPropertyForObject(option, settings.displayProp)}}</a>",r+="</li>",r+='<li class="divider" ng-show="settings.selectionLimit > 1"></li>',r+='<li role="presentation" ng-show="settings.selectionLimit > 1"><a role="menuitem">{{selectedModel.length}} {{texts.selectionOf}} {{settings.selectionLimit}} {{texts.selectionCount}}</a></li>',r+="</ul>",r+="</div>",e.html(r)},link:function(o,r,s){function l(e){var t={};return""===o.settings.externalIdProp?t[o.settings.idProp]=e:t[o.settings.externalIdProp]=e,t}function i(e){for(var t in e)delete e[t]}var a=r.children()[0];o.toggleDropdown=function(){o.open=!o.open},o.checkboxClick=function(e,t){o.setSelectedItem(t),e.stopImmediatePropagation()},o.externalEvents={onItemSelect:e.noop,onItemDeselect:e.noop,onSelectAll:e.noop,onDeselectAll:e.noop,onInitDone:e.noop,onMaxSelectionReached:e.noop},o.settings={dynamicTitle:!0,scrollable:!1,scrollableHeight:"300px",closeOnBlur:!0,displayProp:"name",idProp:"id",externalIdProp:"id",enableSearch:!1,selectionLimit:0,showCheckAll:!1,showUncheckAll:!1,closeOnSelect:!1,buttonClasses:"form-control",closeOnDeselect:!1,groupBy:s.groupBy||void 0,groupByTextProvider:null,smartButtonMaxItems:0,smartButtonTextConverter:e.noop},o.texts={checkAll:"Označ všetko",uncheckAll:"Odznač všetko",selectionCount:"checked",selectionOf:"/",searchPlaceholder:"Hľadaj...",buttonDefaultText:"Vyber si z možností",dynamicButtonTextSuffix:"checked"},o.searchFilter=o.searchFilter||"",e.isDefined(o.settings.groupBy)&&o.$watch("options",function(n){e.isDefined(n)&&(o.orderedItems=t("orderBy")(n,o.settings.groupBy))}),e.extend(o.settings,o.extraSettings||[]),e.extend(o.externalEvents,o.events||[]),e.extend(o.texts,o.translationTexts),o.singleSelection=1===o.settings.selectionLimit,o.singleSelection&&e.isArray(o.selectedModel)&&0===o.selectedModel.length&&i(o.selectedModel),o.settings.closeOnBlur&&n.on("click",function(t){for(var n=t.target.parentElement,r=!1;e.isDefined(n)&&null!==n&&!r;)_.contains(n.className.split(" "),"multiselect-parent")&&!r&&n===a&&(r=!0),n=n.parentElement;r||o.$apply(function(){o.open=!1})}),o.getGroupTitle=function(e){return null!==o.settings.groupByTextProvider?o.settings.groupByTextProvider(e):e},o.getButtonText=function(){if(o.settings.dynamicTitle&&(o.selectedModel.length>0||e.isObject(o.selectedModel)&&_.keys(o.selectedModel).length>0)){if(o.settings.smartButtonMaxItems>0){var t=[];return e.forEach(o.options,function(e){if(o.isChecked(o.getPropertyForObject(e,o.settings.idProp))){var n=o.getPropertyForObject(e,o.settings.displayProp),r=o.settings.smartButtonTextConverter(n,e);t.push(r?r:n)}}),o.selectedModel.length>o.settings.smartButtonMaxItems&&(t=t.slice(0,o.settings.smartButtonMaxItems),t.push("...")),t.join(", ")}var n;return n=o.singleSelection?null!==o.selectedModel&&e.isDefined(o.selectedModel[o.settings.idProp])?1:0:e.isDefined(o.selectedModel)?o.selectedModel.length:0,0===n?o.texts.buttonDefaultText:n+" "+o.texts.dynamicButtonTextSuffix}return o.texts.buttonDefaultText},o.getPropertyForObject=function(t,n){return e.isDefined(t)&&t.hasOwnProperty(n)?t[n]:""},o.selectAll=function(){o.deselectAll(!1),o.externalEvents.onSelectAll(),e.forEach(o.options,function(e){o.setSelectedItem(e[o.settings.idProp],!0)})},o.deselectAll=function(e){e=e||!0,e&&o.externalEvents.onDeselectAll(),o.singleSelection?i(o.selectedModel):o.selectedModel.splice(0,o.selectedModel.length)},o.setSelectedItem=function(t,n){var r=l(t),s=null;if(s=""===o.settings.externalIdProp?_.find(o.options,r):r,o.singleSelection)return i(o.selectedModel),e.extend(o.selectedModel,s),void o.externalEvents.onItemSelect(s);n=n||!1;var a=-1!==_.findIndex(o.selectedModel,r);!n&&a?(o.selectedModel.splice(_.findIndex(o.selectedModel,r),1),o.externalEvents.onItemDeselect(r)):!a&&(0===o.settings.selectionLimit||o.selectedModel.length<o.settings.selectionLimit)&&(o.selectedModel.push(s),o.externalEvents.onItemSelect(s))},o.isChecked=function(t){return o.singleSelection?null!==o.selectedModel&&e.isDefined(o.selectedModel[o.settings.idProp])&&o.selectedModel[o.settings.idProp]===l(t)[o.settings.idProp]:-1!==_.findIndex(o.selectedModel,l(t))},o.externalEvents.onInitDone()}}}t.$inject=["$filter","$document","$compile","$parse"],e.module("common").directive("dropdownMultiselect",t)}(angular),function(e){"use strict";function t(){var e=function(e,t,n){e.$on("export-excel",function(e,n){t.tableExport({type:"excel",escape:!1})}),e.$on("export-doc",function(e,n){
t.tableExport({type:"doc",escape:!1})})};return{restrict:"C",link:e}}e.module("common").directive("exportTable",t)}(angular),function(e){"use strict";function t(){return{templateUrl:"/app/common/templates/wait-cursor.template.html"}}e.module("common").directive("waitCursor",t)}(angular),function(e){"use strict";function t(){return function(e,t){return(1e6+e+"").slice(-t)}}e.module("common").filter("numberFixedLen",t)}(angular),function(e){"use strict";function t(t){function n(n,o){return o=o?-1:1,n.map(function(n){var r=1,s=e.identity,l=!1;if(e.isFunction(n))s=n;else if(e.isString(n)&&("@"==n.charAt(0)&&(l=!0,n=n.substring(1)),"+"!=n.charAt(0)&&"-"!=n.charAt(0)||(r="-"==n.charAt(0)?-1:1,n=n.substring(1)),""!==n&&(s=t(n),s.constant))){var i=s();s=function(e){return e[i]}}return{get:s,descending:r*o,localeAware:l}})}function o(e){switch(typeof e){case"number":case"boolean":case"string":return!0;default:return!1}}function r(e,t){return"function"==typeof e.valueOf&&(e=e.valueOf(),o(e))?e:i(e)&&(e=e.toString(),o(e))?e:t}function s(e,t){var n=typeof e;return null===e?(n="string",e="null"):"string"===n?e=e.toLowerCase():"object"===n&&(e=r(e,t)),{value:e,type:n}}function l(e,t){var n=0;return"string"===e.type?n=e.value.toString().localeCompare(t.value.toString(),"sk"):e.type===t.type?e.value!==t.value&&(n=e.value<t.value?-1:1):n=e.type<t.type?-1:1,n}function i(t){return e.isFunction(t.toString)&&t.toString!==Object.prototype.toString}return function(t,o,r){function i(e,t){return{value:e,predicateValues:c.map(function(n){return s(n.get(e),t)})}}function a(e,t){for(var n=0,o=0,r=c.length;r>o&&!(n=l(e.predicateValues[o],t.predicateValues[o],c[o].localeAware)*c[o].descending);++o);return n}if(!t||!e.isArray(t))return t;e.isArray(o)||(o=[o]),0===o.length&&(o=["+"]);var c=n(o,r);c.push({get:function(){return{}},descending:r?-1:1});var u=Array.prototype.map.call(t,i);return u.sort(a),t=u.map(function(e){return e.value})}}t.$inject=["$parse"],e.module("common").filter("orderBySk",t)}(angular);