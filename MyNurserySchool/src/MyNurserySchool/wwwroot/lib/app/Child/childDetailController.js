!function(){"use strict";function t(t,n,e,i,o,s){function l(){n.get("/Api/Class/"+a.child.classId).then(function(t){a.classTitle=t.data.name},function(){toastr.error("Nepodarilo sa načítať informácie o škôlke")})["finally"](function(){a.isBusy=!1})}s("baseController",{$scope:t});var a=this;a.childId=i.id,a.child={},a.newNote={},a.attendanceStates=["Žiadateľ","Docházdajúci","Odstúpený"],a.isBusy=!0,n.get("/Api/Child/"+a.childId).then(function(t){angular.copy(t.data,a.child),a.classId=a.child.classId,a.child.description=a.child.description?o.trustAsHtml(a.child.description.replace(/(\r\n|\n|\r)/gm,"<br />")):null,a.child.contacts=a.child.contacts?o.trustAsHtml(a.child.contacts.replace(/(\r\n|\n|\r)/gm,"<br />")):null,l();for(var n=0;n<a.child.notes.length;n++)null!=a.child.notes[n].text&&(a.child.notes[n].text=o.trustAsHtml(a.child.notes[n].text.replace(/(\r\n|\n|\r)/gm,"<br />")))},function(){toastr.error("Nepodarilo sa načítať informácie o dieťati")})["finally"](function(){a.isBusy=!1}),a.deleteChild=function(){a.isBusy=!0,n["delete"]("/Api/Child/"+a.child.id).then(function(){toastr.success("Dieťa bolo vymazané"),e.path("#/class/"+a.classId)},function(t){toastr.error("Dieťa sa nepodarilo vymazať")})["finally"](function(){a.isBusy=!1})},a.saveNote=function(){a.isBusy=!0,a.newNote.childId=a.childId,n.post("/Api/Note/",a.newNote).then(function(t){a.child.notes.push(t.data),a.child.notes[a.child.notes.length-1].text=o.trustAsHtml(a.child.notes[a.child.notes.length-1].text.replace(/(\r\n|\n|\r)/gm,"<br />")),toastr.success("Poznámka bola zapísaná"),a.newNote={}},function(t){toastr.error("Poznámku sa nepodarilo zapísať")})["finally"](function(){a.isBusy=!1})},a.deleteNote=function(t){a.isBusy=!0,n["delete"]("/Api/Note/"+t).then(function(){for(var n=0;n<a.child.notes.length;n++){var e=a.child.notes[n];e.id==t&&a.child.notes.splice(n,1)}toastr.success("Poznámka bola vymazaná")},function(t){toastr.error("Poznámku sa nepodarilo vymazať")})["finally"](function(){a.isBusy=!1})}}t.$inject=["$scope","$http","$location","$routeParams","$sce","$controller"],angular.module("nursery-app").controller("childDetailController",t)}();